<HTML>
<head>
<LINK REL=StyleSheet HREF="css/swarmer.css" TYPE="text/css" MEDIA=screen>
<script src="js/d3.js" charset="utf-8"></script>
<script src="js/initial.js" charset="utf-8"></script>
<script src="js/update.js" charset="utf-8"></script>
</head
<body>
  <div id="controls-wrapper">
    <div id="gridControls" class="control-panel">
      <ul class="control-group">
        <li>
          <label for="arrity">Grid Arrity</label>
          <input id="arrity" type="range" min="3" max="10" step="1" value="6" onChange="updateArrity(this.value)">
        </li>
        <li>
          <label for="tileSize">Tile Size</label>
          <input id="tileSize" type="range" min="10" max="100" step="10" value="50" onChange="updateArrity(this.value)">
        </li>
        <li>
          <label for="gridScale">Grid Scale</label>
          <input id="gridScale" type="range" min="1" max="10" step="1" value="3" onChange="updateArrity(this.value)">
        </li>
      </ul>
    </div>
  
    <div id="simControls" class="control-panel">
      <ul class="control-group">
        <li>
          <label for="swarmSize">Swarm Size</label>
          <input id="swarmSize" type="range" min="5" max="500" value="200" step="1"  />
        </li>
        <li>
          <label for="simspeed">Simulation Speed</label>
          <input id="simspeed" type="range" min="3" max="30" value="3" step="3" disabled />
        </li>
        <li>
          <label for="movespeed">Movement Speed</label>
          <input id="movespeed" type="range" min="3" max="30" value="3" step="3"disabled />
        </li>
      </ul>
    </div>
  </div><!-- end control-wrapper -->
    
  <div id="inspector-wrapper">
    <textarea id="inspector" readonly>hello i'm your textfield, try and edit me! Go on try!</textarea>
    <div id="button-wrapper">
      <ul class="control-group">
        <li>
          <button onClick="start()">Start</button>
        </li>
        <li>
          <button>Pause</button>
        </li>
        <li>
          <button>Reset</button>
        </li>
      </ul>
    </div> <!-- end button-wrapper -->
  </div> <!-- end  inspector-wrapper-->

  <!-- main display -->
  <svg>
  </svg>
  <!-- end of display -->

</body>

<script type="text/javascript">
  var inspectList =[]; // global variables
  var inspector = document.getElementById("inspector");// global variables
  socket= new WebSocket('ws://localhost:8080/websocket');
  // this will run as soon as the scoket is established
  socket.onopen= function() {
    // collect rhe values from the controls
    var arrity = document.getElementById('arrity').value;
    var tileSize = document.getElementById('tileSize').value;
    var gridScale = document.getElementById('gridScale').value;
    var swarmSize= document.getElementById("swarmSize").value;
    // compile a JSON object and send it to the socket
    var json = JSON.stringify({"type":"setup","arrity":arrity,"tileSize":tileSize});
    socket.send(json);
    // this part will run when the reply comes back from the socket
    socket.onmessage = function(evt) {
      // data from the reply
      var data = JSON.parse(evt.data);
      // I'm replacing the value from the arrity slider with the one from the socket reply
      // I don't really need to do this
      arrity = data.rows;
      var size = data.tileSize;
      // call the function to draw the grid
      setup_grid(arrity,size,gridScale);
      // Send a JSON to set up the swarm
      var swarm_json = JSON.stringify({"type":"swarm","size":swarmSize});
      socket.send(swarm_json);
      // recieve a message back
        socket.onmessage = function(sw) {
          // draw the swarm
          swarm_data = JSON.parse(sw.data);
          draw_circles(swarm_data,gridScale);
        };
      };
    };
</script>
<script type="text/javascript">
</script>
</HTML>
